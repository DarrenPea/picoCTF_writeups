# SOAP

- [Description](#description)
- [Approach](#approach)
- [Flag](#flag)

## Description

The web project was rushed and no security assessment was done. Can you read the /etc/passwd file?
Additional details will be available after launching your challenge instance.

[Web Portal](http://saturn.picoctf.net:51709/)

## Approach

Using Burp Suite, it seems that whenever we request to view the details using the 'Details' button, we send a XML request to request data based on an ID value.

<p align="center">
  <img src="https://raw.githubusercontent.com/DarrenPea/picoCTF_writeups/refs/heads/main/picoCTF-2023/Web-Exploitation/SOAP/img/original.png" />
</p>

Looking into [XML External Entity (XXE) injection](https://portswigger.net/web-security/xxe), we could define an external entity that reads the content of the `/etc/passwd` file. 

First, I will introduce a `DOCTYPE` element so that I can define my external entity, which contains the path to the file, with the URI scheme `file://`. Secondly, I will change the ID value such that it will return my external entity by calling `&xxe;`.

My final payload would be:
```
<?xml version="1.0" encoding="UTF-8">
	<!DOCTYPE foo[ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]><data>
		<ID>
			&xxe;
		</ID>
	</data>
```

<p align="center">
  <img src="https://raw.githubusercontent.com/DarrenPea/picoCTF_writeups/refs/heads/main/picoCTF-2023/Web-Exploitation/SOAP/img/flag.png" />
</p>

## Flag

`picoCTF{XML_3xtern@l_3nt1t1ty_0dcf926e}`