# JaWT Scratchpad

- [Description](#description)
- [Approach](#approach)
- [Flag](#flag)

## Description

Check the admin scratchpad! `https://jupiter.challenges.picoctf.org/problem/61864/` or http://jupiter.challenges.picoctf.org:61864

## Approach

Upon loading the website, it seems that I need to login as `admin` as my name to obtain the flag.

<p align="center">
  <img src="https://raw.githubusercontent.com/DarrenPea/picoCTF_writeups/refs/heads/main/picoCTF-2019/Web-Exploitation/JaWT-Scratchpad/img/start.png" />
</p>

If I try to log in as `admin`, it gets rejected so I used Burp Suite to analyse the HTTP headers and payload.

<p align="center">
  <img src="https://raw.githubusercontent.com/DarrenPea/picoCTF_writeups/refs/heads/main/picoCTF-2019/Web-Exploitation/JaWT-Scratchpad/img/failed_admin.png" />
</p>

When logging in with a normal username, a cookie is being set for the user to remain logged in.

<p align="center">
  <img src="https://raw.githubusercontent.com/DarrenPea/picoCTF_writeups/refs/heads/main/picoCTF-2019/Web-Exploitation/JaWT-Scratchpad/img/user.png" />
</p>

I used an [online tool](https://jwt.io/) for encoding and decoding the cookie. It seems that HS256 algorithm is being used, and the payload is just the username.

<p align="center">
  <img src="https://raw.githubusercontent.com/DarrenPea/picoCTF_writeups/refs/heads/main/picoCTF-2019/Web-Exploitation/JaWT-Scratchpad/img/john.png" />
</p>

I tried to set the cookie by replacing `HS256` algorithm to `None` as the server may not check for the signature, but this reuslted in internal server error. <br>

To set a cookie with `"user": "admin"`, I would have to find out the key used in the HS256 algorithm in order to create a valid signature. Hence, I used hashcat to obtain the key using the wordlist `rockyou.txt`, with the hash mode for JWT.

```
$ hashcat -a 0 -m 16500 cookie.txt /usr/share/wordlists/rockyou.txt
...
Dictionary cache hit:
* Filename..: /usr/share/wordlists/rockyou.txt
* Passwords.: 14344385
* Bytes.....: 139921507
* Keyspace..: 14344385

eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjoiam9obiJ9._fAF3H23ckP4QtF1Po3epuZWxmbwpI8Q26hRPDTh32Y:ilovepico
```

Then, I got the JWT cookie with `ilovepico` as the HS256 algorithm's key.

<p align="center">
  <img src="https://raw.githubusercontent.com/DarrenPea/picoCTF_writeups/refs/heads/main/picoCTF-2019/Web-Exploitation/JaWT-Scratchpad/img/admin_cookie.png" />
</p>

Upon trying to login as `admin` after setting the cookie found above, the flag is obtained.

<p align="center">
  <img src="https://raw.githubusercontent.com/DarrenPea/picoCTF_writeups/refs/heads/main/picoCTF-2019/Web-Exploitation/JaWT-Scratchpad/img/flag.png" />
</p>

## Flag

`picoCTF{jawt_was_just_what_you_thought_1ca14548}`