# JAuth

- [Description](#description)
- [Approach](#approach)
- [Flag](#flag)

## Description

Most web application developers use third party components without testing their security. Some of the past affected companies are:
Equifax (a US credit bureau organization) - breach due to unpatched Apache Struts web framework CVE-2017-5638
Mossack Fonesca (Panama Papers law firm) breach - unpatched version of Drupal CMS used
VerticalScope (internet media company) - outdated version of vBulletin forum software used
Can you identify the components and exploit the vulnerable one?
Additional details will be available after launching your challenge instance.

The website is running [here](). Can you become an admin?
You can login as test with the password Test123! to get started.

## Approach

Using Burpsuite to intercept the web request and responses, I logged in to the test account.

<p align="center">
  <img src="https://raw.githubuserconthttp://saturn.picoctf.net:57193/ent.com/DarrenPea/picoCTF_writeups/refs/heads/main/picoGym-Exclusive/Web-Exploitation/JAuth/img/test.png" />
</p>

Looking at the JSON Web Token (JWT), I tried decoding it using Cyberchef. 

JWT Payload:

```json
{
    "auth": 1731634774216,
    "agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36",
    "role": "user",
    "iat": 1731634774
}
```

Looking through possible vulnerabilities related to JWT, there is a vulnerability where the signing algorithm is `None` in its header. This can result in arbitrary access as some libraries treats such tokens as valid, with a verified signature.

Then, I crafted my own payload, signed with the `None` algorithm.

<p align="center">
  <img src="https://raw.githubusercontent.com/DarrenPea/picoCTF_writeups/refs/heads/main/picoGym-Exclusive/Web-Exploitation/JAuth/img/signing.png" />
</p>

Lastly, I sent the payload and obtained the flag.

<p align="center">
  <img src="https://raw.githubusercontent.com/DarrenPea/picoCTF_writeups/refs/heads/main/picoGym-Exclusive/Web-Exploitation/JAuth/img/admin.png" />
</p>

## Flag

`picoCTF{succ3ss_@u7h3nt1c@710n_3444eacf}`