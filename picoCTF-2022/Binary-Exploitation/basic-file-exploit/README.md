# basic-file-exploit

- [Description](#description)
- [Approach](#approach)
- [Flag](#flag)

## Description

The program provided allows you to write to a file and read what you wrote from it. Try playing around with it and see if you can break it! <br>
The program's source code with the flag redacted can be downloaded [here](https://artifacts.picoctf.net/c/140/program-redacted.c). <br>
Additional details will be available after launching your challenge instance.

Connect to the program with netcat:
`$ nc saturn.picoctf.net 54324`

## Approach

Looking at the `data_read()` function, it seems that the flag is obtained by satisfying the following condition.

```c
if ((entry_number = strtol(entry, NULL, 10)) == 0) {
	puts(flag);
	fseek(stdin, 0, SEEK_END);
	exit(0);
}
```

`strtol` function in C converts a string to a long type. To satisfy this condition and read the flag, `strtol` would have to return 0, which will occur when `entry` is "" or a string of letters instead of numberes so it cannot be converted to long type.

So, I created an entry in the database, then proceeded to read entry number: "" or alternatively, "abc" to obtain the flag.

## Flag

`picoCTF{M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_68466E2F}`