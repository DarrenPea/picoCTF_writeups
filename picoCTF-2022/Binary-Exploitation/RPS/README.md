# RPS

- [Description](#description)
- [Approach](#approach)
- [Flag](#flag)

## Description

Here's a program that plays rock, paper, scissors against you. I hear something good happens if you win 5 times in a row. <br>
The program's source code with the flag redacted can be downloaded [here](https://artifacts.picoctf.net/c/145/game-redacted.c). <br>
Additional details will be available after launching your challenge instance.

Connect to the program with netcat: <br>
`$ nc saturn.picoctf.net 57195`

## Approach

Looking at the C code provided, it seems like we have to win RNG 5 times in a row. There should be a way to work around it. Looking at the `play()` function, which determines who won the round, it seems to compare `player_turn` and `loses[computer_turn]` to determine who won. 

```c
int computer_turn = rand() % 3;
printf("You played: %s\n", player_turn);
printf("The computer played: %s\n", hands[computer_turn]);

if (strstr(player_turn, loses[computer_turn])) {
	puts("You win! Play again?");
	return true;
} else {
	puts("Seems like you didn't win this time. Play again?");
	return false;
}
```

`strstr` function in C is actually used to find the first occurence of a substring inside a larger string, and returns a pointer to the first character of the found substring, else it returns a null pointer.

If I could input `rockpaperscissors`, the `strstr` function will always return True since regardless of what the program chooses, it is a substring that exists in `rockpaperscissors`.

## Flag

`picoCTF{50M3_3X7R3M3_1UCK_58F0F41B}`