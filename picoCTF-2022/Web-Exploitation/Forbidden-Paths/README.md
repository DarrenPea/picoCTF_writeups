# Forbidden Paths

- [Description](#description)
- [Approach](#approach)
- [Flag](#flag)

## Description

We know that the website files live in `/usr/share/nginx/html/` and the flag is at `/flag.txt` but the website is filtering absolute file paths. Can you get past the filter to read the flag? <br>
Additional details will be available after launching your challenge instance.

Here's the [website](http://saturn.picoctf.net:59615/).

## Approach

When trying to read `/flag.txt` from the website, it mentions `Not Authorised`. Upon inspecting the website, it appears that our input is being processed by `read.php`.

<p align="center">
  <img src="https://raw.githubusercontent.com/DarrenPea/picoCTF_writeups/refs/heads/main/picoCTF-2022/Web-Exploitation/Forbidden-Paths/img/read.png" />
</p>

So, I used `read.php` as my input to read the PHP file. It appears that we just need to avoid using `/` as the first character. Then, the input is proceesed using `fopen` to read the file.

As such, we could use traverse through directories to `/`, before reading `flag.txt`. This way, our input will start with `..` instead of `/`.

<p align="center">
  <img src="https://raw.githubusercontent.com/DarrenPea/picoCTF_writeups/refs/heads/main/picoCTF-2022/Web-Exploitation/Forbidden-Paths/img/php.png" />
</p>

To reach `/`, we need to use `..` 4 times, hence I gave `../../../../flag.txt` as my input and obtained the flag.

<p align="center">
  <img src="https://raw.githubusercontent.com/DarrenPea/picoCTF_writeups/refs/heads/main/picoCTF-2022/Web-Exploitation/Forbidden-Paths/img/flag.png" />
</p>

## Flag

`picoCTF{7h3_p47h_70_5ucc355_e5fe3d4d}`