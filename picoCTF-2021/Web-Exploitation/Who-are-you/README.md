# Who are you?

- [Description](#description)
- [Approach](#approach)
- [Flag](#flag)

## Description

Let me in. Let me iiiiiiinnnnnnnnnnnnnnnnnnnn http://mercury.picoctf.net:52362/

## Approach

Looking at the website, it only allows people that use the `PicoBrowser`.

<p align="center">
  <img src="https://raw.githubusercontent.com/DarrenPea/picoCTF_writeups/refs/heads/main/picoCTF-2021/Web-Exploitation/Who-are-you/img/user-agent.png" />
</p>

As such, I used Burp Suite to change the `User-Agent` header, which allows servers to identify the application, OS, etc of the browser making the request. <br>
`User-Agent: PicoBrowser`

Then, it says that it doesn't trust users from another website.

<p align="center">
  <img src="https://raw.githubusercontent.com/DarrenPea/picoCTF_writeups/refs/heads/main/picoCTF-2021/Web-Exploitation/Who-are-you/img/referer.png" />
</p>

The `Referer` header defines the address from which a resource has been requested so I added the site to this header. <br>
`Referer: mercury.picoctf.net:52362`

It says that this site is only working in 2018.

<p align="center">
  <img src="https://raw.githubusercontent.com/DarrenPea/picoCTF_writeups/refs/heads/main/picoCTF-2021/Web-Exploitation/Who-are-you/img/date.png" />
</p>

Using the `Date` header, I defined the time at which the request originated to be 2018. <br>
`Date: Thu, 14 Jun 2018 09:20:20 GMT`

It then says that it does not trust users who can be tracked.

<p align="center">
  <img src="https://raw.githubusercontent.com/DarrenPea/picoCTF_writeups/refs/heads/main/picoCTF-2021/Web-Exploitation/Who-are-you/img/dnt.png" />
</p>

I found the `DNT` header, which indicates the user's tracking perferences, where `0` prefers tracking on the target site while `1` is a preference of not being tracked on the site. <br>
`DNT: 1`

Then, it mentions that the website is only for people from Sweden.

<p align="center">
  <img src="https://raw.githubusercontent.com/DarrenPea/picoCTF_writeups/refs/heads/main/picoCTF-2021/Web-Exploitation/Who-are-you/img/x-forwarded-for.png" />
</p>

With the `X-Forwarded-For` header, it is used to identify the original IP address of the client. Hence, I looked for an IP address in Sweden. <br>
`X-Forwarded-For: 102.177.146.0`

Then, it checks if I speak Swedish.

<p align="center">
  <img src="https://raw.githubusercontent.com/DarrenPea/picoCTF_writeups/refs/heads/main/picoCTF-2021/Web-Exploitation/Who-are-you/img/accept-language.png" />
</p>

The `Accept-Language` header indicates the languages that the client can understand. So, I just added Swedish (`sv`) to the list of languages that I can understand. <br>
`Accept-Language: en-GB,en;q=0.9, sv`

Finally, the flag is obtained.

<p align="center">
  <img src="https://raw.githubusercontent.com/DarrenPea/picoCTF_writeups/refs/heads/main/picoCTF-2021/Web-Exploitation/Who-are-you/img/flag.png" />
</p>

## Flag

`picoCTF{http_h34d3rs_v3ry_c0Ol_much_w0w_0c0db339}`