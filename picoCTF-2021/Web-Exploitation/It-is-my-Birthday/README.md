# It is my Birthday

- [Description](#description)
- [Approach](#approach)
- [Flag](#flag)

## Description

I sent out 2 invitations to all of my friends for my birthday! I'll know if they get stolen because the two invites look similar, and they even have the same md5 hash, but they are slightly different! You wouldn't believe how long it took me to find a collision. Anyway, see if you're invited by submitting 2 PDFs to my website. http://mercury.picoctf.net:20277/

## Approach

Upon inspecting the webpage, it seems to check the md5 hash of both pdfs in `/index.php`. There exists [magic hashes](https://github.com/spaze/hashes?tab=readme-ov-file) for PHP hash 'collisions', when PHP uses `==` to compare 2 different hashes.

Looking at the [list](https://github.com/spaze/hashes/blob/master/md5.md), I selected 2 colliding hashes and placed them in PDF files. When storing the values in the PDF file using `nano`, the `-L` flag is necessary to prevent the automatic creation of new line at the end of the file, else the md5 sum will differ.

```
$ md5sum file1.pdf
0e462097431906509019562988736854  file1.pdf

$ md5sum file2.pdf
0e405967825401955372549139051580  file2.pdf
```

After submitting the PDFs, it can be seen how the md5 check was done.

```
if (md5_file($_FILES["file1"]["tmp_name"]) == md5_file($_FILES["file2"]["tmp_name"])) {
	highlight_file("index.php");
	die();
} else {
	echo "MD5 hashes do not match!";
	die();
}
```

From `index.php`, the flag is obtained.

## Flag

`picoCTF{c0ngr4ts_u_r_1nv1t3d_da36cc1b}`